# 未完成功能清单（复核版）

> 基于《设计方案.md》与当前前后端代码逐项对照，梳理尚未实现或接口契约不匹配的能力，供后续排期参考。【F:docs/设计方案.md†L70-L138】

## Go 后端服务缺口

1. **学生冒险地图与进度接口**
   * 设计稿要求提供章节 → 关卡的分层地图以及解锁/完成状态，作为学生端导航的基础。【F:docs/设计方案.md†L70-L81】
   * 前端 `loadChapters` 与关卡列表页面直接消费 `/student/map` 返回的 `chapters` 数组，并基于每个关卡的 `status` 进行过滤展示。【F:frontend/apps/web/src/store/useAppStore.ts†L266-L283】【F:frontend/apps/web/src/app/pages/student/LevelsPage.tsx†L24-L188】
   * 后端 Student 服务仍返回空的 `levels` 数组，且 OpenAPI 中也只暴露扁平 `levels` 结构，缺失章节信息与真实进度数据。【F:backend/internal/service/student/service.go†L11-L46】【F:backend/api/openapi.yaml†L232-L238】

2. **学生关卡详情/准备/运行协议**
   * PlayPage 在进入关卡时会并发请求 `/student/levels/:id` 与 `/student/levels/:id/prep` 以拉取状态、历史成绩与准备数据，并在完成后调用 `/student/levels/:id/complete` 和 `/student/hints/:id`。【F:frontend/apps/web/src/app/pages/student/PlayPage.tsx†L24-L154】【F:frontend/apps/web/src/store/useAppStore.ts†L310-L409】
   * 路由层只注册了 `prep/run/complete/sandbox` 的 POST/GET，其中缺少 `GET /student/levels/:id`、`POST /student/hints/:id`、`GET/PUT /student/settings`、`POST /student/settings/reset-progress`、`GET/PUT /student/avatar` 等前端依赖的接口。【F:backend/internal/http/router/router.go†L62-L69】【F:frontend/apps/web/src/services/api/client.ts†L321-L380】
   * 运行/结算契约不匹配：前端向 `/student/levels/:id/run` 发送 `{ program: any[] }` 并期望返回模拟结果，而后端 DTO 仍要求 `{ code: string, language: string }`，导致协议不一致。【F:frontend/apps/web/src/services/api/client.ts†L343-L355】【F:backend/internal/http/dto/dto.go†L41-L58】
   * 结算接口期望 `{ score, completedAt }`，但前端提交 `{ stars, steps, hints, duration, bestDifference }`，目前后端实现也只是空操作，无法保存成绩。【F:frontend/apps/web/src/services/api/client.ts†L347-L355】【F:backend/internal/service/student/service.go†L21-L34】【F:backend/internal/http/dto/dto.go†L54-L58】

3. **教师侧数据接口缺失**
   * 教师端仪表盘、作业布置与分析页分别请求班级列表、课程列表、待审核作品与多个 analytics 资源。【F:frontend/apps/web/src/app/pages/teacher/OverviewPage.tsx†L19-L200】【F:frontend/apps/web/src/app/pages/teacher/AssignmentsPage.tsx†L24-L120】【F:frontend/apps/web/src/app/pages/teacher/AnalyticsPage.tsx†L19-L120】
   * 后端仅暴露 `/teacher/analytics/*resource` 并返回 `{resource, data: []}` 的占位响应，缺少 `/teacher/classes`、`/teacher/courses`、`/teacher/works` 等接口实现，导致所有教师页面无法获得真实数据。【F:backend/internal/http/router/router.go†L71-L74】【F:backend/internal/service/teacher/service.go†L5-L16】

4. **家长与管理员接口未实现**
   * 家长端需要 `/parent/overview`、`/parent/children/:id/progress`、`/parent/settings` 等接口以展示孩子进度与提醒配置，而后端完全未注册任何 `/parent/*` 路由。【F:frontend/apps/web/src/services/api/client.ts†L420-L442】
   * 管理端期望 `/admin/overview` 等统计接口，同样在当前路由表中缺失。【F:frontend/apps/web/src/services/api/client.ts†L444-L452】【F:backend/internal/http/router/router.go†L48-L78】

5. **实时与作业队列占位**
   * 学生服务的 `Run`/`Sandbox` 返回固定字符串“Execution pending”，教师 analytics 亦返回空数组，未对接实际执行引擎或作业队列，无法支持实时运行与回放需求。【F:backend/internal/service/student/service.go†L21-L34】【F:backend/internal/service/teacher/service.go†L11-L16】

## Web 前端（多角色）缺口

### 学生端

* 地图、准备与关卡流程依赖的章节、进度、提示、设置、装扮等 API 均无后端支撑，导致 `loadChapters`、`loadStudentData`、`getHint`、`updateStudentSettings` 等动作无法得到有效响应。【F:frontend/apps/web/src/store/useAppStore.ts†L244-L409】【F:frontend/apps/web/src/services/api/client.ts†L321-L380】
* Achievements/Outfits 页面以学生档案与章节数据计算成就、装扮解锁，但档案请求指向未实现的 `/student/profile`，目前只能读取缓存，无法展示真实奖励来源。【F:frontend/apps/web/src/app/pages/student/AchievementsPage.tsx†L145-L214】【F:frontend/apps/web/src/services/api/client.ts†L321-L380】
* Hint 体系仍为一次性文本模态，尚未落实设计中“失败次数分层提示与动效反馈”的逻辑。【F:docs/设计方案.md†L118-L123】【F:frontend/apps/web/src/app/pages/student/PlayPage.tsx†L134-L218】

### 教师端

* 概览、作业、课程与分析页面全部依赖未实现的 `/teacher/*` 数据源，目前只能渲染空状态或静态统计；教师登录流程虽已开放，但缺乏角色鉴权与数据回填。 【F:frontend/apps/web/src/app/pages/teacher/OverviewPage.tsx†L37-L200】【F:frontend/apps/web/src/app/pages/teacher/AssignmentsPage.tsx†L37-L123】【F:frontend/apps/web/src/app/pages/teacher/AnalyticsPage.tsx†L33-L120】【F:docs/设计方案.md†L83-L89】

### 家长端

* 家长首页、进度与设置页均直接调用 `/parent/overview`、`/parent/children/:id/*`、`/parent/settings`，由于后端未实现，这些页面会落入错误或空态，无法满足“查看学习进度与周报”的核心需求。【F:frontend/apps/web/src/app/pages/parent/HomePage.tsx†L10-L123】【F:frontend/apps/web/src/app/pages/parent/SettingsPage.tsx†L10-L108】【F:docs/设计方案.md†L91-L94】

### 管理端

* 管理后台多个页面仍是硬编码占位（关键指标、用户列表、课程编辑、运营位），没有接入任何真实数据或操作能力，与设计中“运营与风控、素材管理、数据导出”的目标尚有距离。【F:docs/设计方案.md†L61-L64】【F:frontend/apps/web/src/app/pages/admin/OverviewPage.tsx†L1-L20】【F:frontend/apps/web/src/app/pages/admin/UsersPage.tsx†L1-L46】【F:frontend/apps/web/src/app/pages/admin/CurriculumPage.tsx†L1-L10】【F:frontend/apps/web/src/app/pages/admin/OpsPage.tsx†L1-L24】

## 建议

* 先补齐学生端最小可用 API（地图/关卡详情/运行/结算/提示/设置），并调整契约与前端一致，再逐步实现教师、家长、管理员所需的资源集合。
* 对齐 OpenAPI 契约与前端请求体字段，避免协议不一致导致的 400/500 错误。
* 为教师、家长、管理员角色分别设计最小数据模型，逐步替换前端静态占位数据。
