# å­¦ç”Ÿç«¯åŠŸèƒ½æ¸…å•

> 2024/05 èµ·åç«¯å·²è¿ç§»è‡³ Go æœåŠ¡ï¼ˆ`backend`ï¼‰ã€‚æœ¬æ–‡æŒ‰ã€Œç™»å½• â†’ å­¦ä¹  â†’ å¤ç›˜ â†’ ä¸ªæ€§åŒ–ã€æ¢³ç†åŠŸèƒ½ï¼Œå¹¶åœ¨â€œåç«¯çŠ¶æ€â€åˆ—æ ‡æ³¨æ˜¯å¦å·²åœ¨ Go ç‰ˆæœ¬è½åœ°ï¼›æ ‡è®°ä¸ºâ€œğŸš§â€çš„èƒ½åŠ›ä»å¼•ç”¨å†å² Node é€»è¾‘ï¼Œåç»­ä¼šåœ¨ Go ä»£ç åº“ä¸­è¡¥é½ã€‚

## 1. è´¦å·ä¸è¿›å…¥

| åŠŸèƒ½ | å®ç°ä½ç½® | è¯´æ˜ | åç«¯çŠ¶æ€ |
| --- | --- | --- | --- |
| æ¸¸å®¢ä½“éªŒç™»å½• | `AuthModal` è§¦å‘ `apiClient.loginAsGuest` â†’ `POST /api/auth/guest` | éšæœºç”Ÿæˆä½“éªŒè´¦å·ï¼Œè½è‡³ä½“éªŒç­çº§ï¼Œæ”¯æŒåŒ¿åè¯•ç©ã€‚ | âœ… Go |
| ç­çº§é‚€è¯·ç åŠ å…¥ | `AuthModal` è§¦å‘ `apiClient.joinClass` â†’ `POST /api/auth/class` | æ–°å­¦ç”Ÿå¡«å†™å§“åä¸é‚€è¯·ç åè‡ªåŠ¨è½ç­ï¼Œ`useAppStore` æŒä¹…åŒ–çŠ¶æ€ã€‚ | âœ… Go |
| ç™»å½•æ€æŒä¹…åŒ– | `useAppStore`ï¼ˆ`zustand` + `persist`ï¼‰ | å°† `user` ä¸ `chapters` ç¼“å­˜è‡³ `localStorage`ï¼Œåˆ·æ–°é¡µé¢åä¿æŒèº«ä»½ã€‚ | âœ… å‰ç«¯ |

## 2. å­¦ä¹ åœ°å›¾ä¸å…³å¡

| åŠŸèƒ½ | å®ç°ä½ç½® | è¯´æ˜ | åç«¯çŠ¶æ€ |
| --- | --- | --- | --- |
| ç« èŠ‚åœ°å›¾å±•ç¤º | `StudentLevelsPage` â†’ `apiClient.getStudentMap` â†’ `GET /api/student/map` | ä¾æ®è¯¾ç¨‹ç« èŠ‚æ¸²æŸ“ç« èŠ‚å¡ç‰‡ã€å…³å¡çŠ¶æ€ï¼ˆå·²å®Œæˆ/å¯è§£é”/å¾…è§£é”ï¼‰ã€‚ | âœ… Go |
| å…³å¡å‡†å¤‡é¢æ¿ | `LevelDetailPage` â†’ `apiClient.getLevelPrep` â†’ `GET /api/student/levels/:id/prep` | å±•ç¤ºèƒœåˆ©æ¡ä»¶ã€å¯ç”¨ç§¯æœ¨ã€å¥–åŠ±ç­‰å‰ç½®ä¿¡æ¯ã€‚ | âœ… Go |
| BlockEditor æ‹–æ‹½ç¼–æ’ | `BlockEditor.tsx` | æ”¯æŒæ‹–æ‹½æŒ‡ä»¤ã€åµŒå¥—æ§åˆ¶ç»“æ„ã€å‚æ•°é…ç½®ï¼Œå®æ—¶è¯­æ³•æ ¡éªŒã€‚ | âœ… å‰ç«¯ |
| æ¨¡æ‹Ÿè¿è¡Œ/é‡ç½® | `PlayPage` â†’ `apiClient.runLevel` / `resetGame` | å°†ç¼–æ’çš„ç¨‹åºæäº¤åæ’­æ”¾åŠ¨ç”»ï¼Œæ”¯æŒé‡ç½®ã€æç¤ºæ¬¡æ•°æ§åˆ¶ã€‚ | âœ… Goï¼ˆRun æ¥å£ï¼‰ |
| å…³å¡ç»“ç®—ä¸å¥–åŠ± | `PlayPage` â†’ `apiClient.completeLevel` â†’ `POST /api/student/levels/:id/complete` | è®°å½•æ˜Ÿçº§ã€æ­¥æ•°ã€æ—¶é•¿ï¼Œè§£é”è£…æ‰®ä¸æ²™ç›’ï¼Œè§¦å‘ `telemetry`ã€‚ | âœ… Goï¼ˆComplete æ¥å£ï¼‰ |
| Hint æç¤º | `PlayPage` â†’ `apiClient.getHint` â†’ `POST /api/student/hints/:id` | æ ¹æ®å°è¯•æ¬¡æ•°ä¸æœ€åé”™è¯¯è¿”å›åŠ¨æ€æç¤ºã€‚ | ğŸš§ å¾…è¿ç§» |

## 3. æˆå°±ä¸æˆé•¿è®°å½•

| åŠŸèƒ½ | å®ç°ä½ç½® | è¯´æ˜ | åç«¯çŠ¶æ€ |
| --- | --- | --- | --- |
| æˆå°±/å›¾é‰´å±•ç¤º | `AchievementsPage` â†’ `GET /api/student/profile` / `GET /api/student/compendium` | å±•ç¤ºå‹‹ç« ã€å›¾é‰´æ¡ç›®ä»¥åŠå¥–åŠ±çš„è£…æ‰®ã€‚ | ğŸš§ å¾…è¿ç§» |
| è£…æ‰®ç®¡ç† | `SettingsPage` â†’ `apiClient.getStudentAvatar`/`updateStudentAvatar` | æŸ¥çœ‹ä¸åˆ‡æ¢å½“å‰è£…æ‰®ï¼Œæ ¡éªŒæ˜¯å¦å·²è§£é”ã€‚ | ğŸš§ å¾…è¿ç§» |
| å­¦ä¹ å‘¨æŠ¥ | `GET /api/parent/children/:childId/weekly-report` | ä¸å®¶é•¿ç«¯å…±äº«å‘¨æŠ¥æ•°æ®ï¼ˆGo ç‰ˆå°šæœªæä¾›ï¼‰ã€‚ | ğŸš§ å¾…è¿ç§» |
| æ²™ç›’ä½œå“åº“ | `PlayPage` ç»“ç®— â†’ `student/sandbox` ç³»åˆ—æ¥å£ | å®Œæˆè¯¾ç¨‹åè§£é”æ²™ç›’åˆ›ä½œï¼Œæ”¯æŒå‘å¸ƒåˆ°ç­çº§ã€æ•™å¸ˆå®¡æ ¸ã€‚ | âœ… Goï¼ˆè¿è¡Œ/æ²™ç›’æ¥å£ï¼‰ |

## 4. ä¸ªæ€§åŒ–ä¸ç³»ç»Ÿè®¾ç½®

| åŠŸèƒ½ | å®ç°ä½ç½® | è¯´æ˜ | åç«¯çŠ¶æ€ |
| --- | --- | --- | --- |
| éŸ³é‡/è¯­è¨€ç­‰è®¾ç½® | `StudentSettingsPage` â†’ `apiClient.getStudentSettings`/`updateStudentSettings` | æ”¯æŒä¿å­˜è¯­è¨€ã€ä½åŠ¨æ€æ¨¡å¼ã€éŸ³é‡ç­‰åå¥½ã€‚ | ğŸš§ å¾…è¿ç§» |
| è¿›åº¦æ¸…é›¶ | `StudentSettingsPage` â†’ `apiClient.resetStudentProgress` | é‡ç½®å…³å¡è¿›åº¦ä¸æ²™ç›’è§£é”çŠ¶æ€ï¼Œç”¨äºé‡æ–°ä½“éªŒã€‚ | ğŸš§ å¾…è¿ç§» |
| æç¤ºæ¬¡æ•°é™åˆ¶ | æ•™å¸ˆç«¯è®¾ç½® â†’ `apiClient.getHint` | æ•™å¸ˆå¯åœ¨ç­çº§è®¾ç½®æç¤ºæ¬¡æ•°ï¼Œå­¦ç”Ÿç«¯åœ¨å…³å¡ä¸­å°Šé‡é™åˆ¶ã€‚ | ğŸš§ å¾…è¿ç§» |

## 5. æ•°æ®ä¸å¯è§†åŒ–

| åŠŸèƒ½ | å®ç°ä½ç½® | è¯´æ˜ |
| --- | --- | --- |
| å®æ—¶ Telemetry | `backend/internal/service/student`ï¼ˆè§„åˆ’ä¸­ï¼‰â†’ `/api/telemetry` | è®°å½•è¿è¡Œã€æç¤ºç­‰äº‹ä»¶ï¼Œç”¨äºæ•™å¸ˆç«¯å¯è§†åŒ–åˆ†æã€‚ |
| é›†æˆæµ‹è¯• | å¾…è¡¥å…… Go æµ‹è¯• | Node ç‰ˆ Jest æµ‹è¯•å·²åºŸå¼ƒï¼Œè®¡åˆ’ä½¿ç”¨ Go + dockertest é‡å†™ç«¯åˆ°ç«¯ç”¨ä¾‹ã€‚ |

---

> å¦‚éœ€æ’æŸ¥å…·ä½“æµç¨‹ï¼Œå¯ç»“åˆ `backend/internal/http` è¿”å›çš„ JSON ä¸é¡µé¢ç»„ä»¶æŸ¥çœ‹ï¼Œå­¦ç”Ÿç«¯æ‰€æœ‰çŠ¶æ€å‡ç”± `useAppStore` ç®¡ç†ï¼Œå¹¶åœ¨ `frontend/apps/web/src/services/api/client.ts` ä¸­ç»Ÿä¸€å°è£…è¯·æ±‚æ–¹æ³•ã€‚
