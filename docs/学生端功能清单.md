# 学生端功能清单

> 2024/05 起后端已迁移至 Go 服务（`backend`）。本文按「登录 → 学习 → 复盘 → 个性化」梳理功能，并在“后端状态”列标注是否已在 Go 版本落地；标记为“🚧”的能力仍引用历史 Node 逻辑，后续会在 Go 代码库中补齐。

## 1. 账号与进入

| 功能 | 实现位置 | 说明 | 后端状态 |
| --- | --- | --- | --- |
| 游客体验登录 | `AuthModal` 触发 `apiClient.loginAsGuest` → `POST /api/auth/guest` | 随机生成体验账号，落至体验班级，支持匿名试玩。 | ✅ Go |
| 班级邀请码加入 | `AuthModal` 触发 `apiClient.joinClass` → `POST /api/auth/class` | 新学生填写姓名与邀请码后自动落班，`useAppStore` 持久化状态。 | ✅ Go |
| 登录态持久化 | `useAppStore`（`zustand` + `persist`） | 将 `user` 与 `chapters` 缓存至 `localStorage`，刷新页面后保持身份。 | ✅ 前端 |

## 2. 学习地图与关卡

| 功能 | 实现位置 | 说明 | 后端状态 |
| --- | --- | --- | --- |
| 章节地图展示 | `StudentLevelsPage` → `apiClient.getStudentMap` → `GET /api/student/map` | 依据课程章节渲染章节卡片、关卡状态（已完成/可解锁/待解锁）。 | ✅ Go |
| 关卡准备面板 | `LevelDetailPage` → `apiClient.getLevelPrep` → `GET /api/student/levels/:id/prep` | 展示胜利条件、可用积木、奖励等前置信息。 | ✅ Go |
| BlockEditor 拖拽编排 | `BlockEditor.tsx` | 支持拖拽指令、嵌套控制结构、参数配置，实时语法校验。 | ✅ 前端 |
| 模拟运行/重置 | `PlayPage` → `apiClient.runLevel` / `resetGame` | 将编排的程序提交后播放动画，支持重置、提示次数控制。 | ✅ Go（Run 接口） |
| 关卡结算与奖励 | `PlayPage` → `apiClient.completeLevel` → `POST /api/student/levels/:id/complete` | 记录星级、步数、时长，解锁装扮与沙盒，触发 `telemetry`。 | ✅ Go（Complete 接口） |
| Hint 提示 | `PlayPage` → `apiClient.getHint` → `POST /api/student/hints/:id` | 根据尝试次数与最后错误返回动态提示。 | 🚧 待迁移 |

## 3. 成就与成长记录

| 功能 | 实现位置 | 说明 | 后端状态 |
| --- | --- | --- | --- |
| 成就/图鉴展示 | `AchievementsPage` → `GET /api/student/profile` / `GET /api/student/compendium` | 展示勋章、图鉴条目以及奖励的装扮。 | 🚧 待迁移 |
| 装扮管理 | `SettingsPage` → `apiClient.getStudentAvatar`/`updateStudentAvatar` | 查看与切换当前装扮，校验是否已解锁。 | 🚧 待迁移 |
| 学习周报 | `GET /api/parent/children/:childId/weekly-report` | 与家长端共享周报数据（Go 版尚未提供）。 | 🚧 待迁移 |
| 沙盒作品库 | `PlayPage` 结算 → `student/sandbox` 系列接口 | 完成课程后解锁沙盒创作，支持发布到班级、教师审核。 | ✅ Go（运行/沙盒接口） |

## 4. 个性化与系统设置

| 功能 | 实现位置 | 说明 | 后端状态 |
| --- | --- | --- | --- |
| 音量/语言等设置 | `StudentSettingsPage` → `apiClient.getStudentSettings`/`updateStudentSettings` | 支持保存语言、低动态模式、音量等偏好。 | 🚧 待迁移 |
| 进度清零 | `StudentSettingsPage` → `apiClient.resetStudentProgress` | 重置关卡进度与沙盒解锁状态，用于重新体验。 | 🚧 待迁移 |
| 提示次数限制 | 教师端设置 → `apiClient.getHint` | 教师可在班级设置提示次数，学生端在关卡中尊重限制。 | 🚧 待迁移 |

## 5. 数据与可视化

| 功能 | 实现位置 | 说明 |
| --- | --- | --- |
| 实时 Telemetry | `backend/internal/service/student`（规划中）→ `/api/telemetry` | 记录运行、提示等事件，用于教师端可视化分析。 |
| 集成测试 | 待补充 Go 测试 | Node 版 Jest 测试已废弃，计划使用 Go + dockertest 重写端到端用例。 |

---

> 如需排查具体流程，可结合 `backend/internal/http` 返回的 JSON 与页面组件查看，学生端所有状态均由 `useAppStore` 管理，并在 `frontend/apps/web/src/services/api/client.ts` 中统一封装请求方法。
