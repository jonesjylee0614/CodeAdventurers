# å‰ç«¯æŠ€æœ¯æ–‡æ¡£

## ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
2. [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)
3. [é¡¹ç›®ç»“æ„](#é¡¹ç›®ç»“æ„)
4. [æ ¸å¿ƒåŠŸèƒ½](#æ ¸å¿ƒåŠŸèƒ½)
5. [è·¯ç”±ç³»ç»Ÿ](#è·¯ç”±ç³»ç»Ÿ)
6. [çŠ¶æ€ç®¡ç†](#çŠ¶æ€ç®¡ç†)
7. [ç»„ä»¶åº“](#ç»„ä»¶åº“)
8. [API é›†æˆ](#api-é›†æˆ)
9. [æ¸¸æˆå¼•æ“](#æ¸¸æˆå¼•æ“)
10. [å¼€å‘æŒ‡å—](#å¼€å‘æŒ‡å—)

---

## é¡¹ç›®æ¦‚è¿°

**ä»£ç å¥‡å…µ (Code Adventurers)** æ˜¯ä¸€ä¸ªé¢å‘é’å°‘å¹´çš„ç¼–ç¨‹æ•™è‚²å¹³å°ï¼Œé€šè¿‡æ¸¸æˆåŒ–çš„æ–¹å¼è®©å­¦ç”Ÿå­¦ä¹ ç¼–ç¨‹æ¦‚å¿µã€‚

### æ ¸å¿ƒç‰¹æ€§

- ğŸ® **æ¸¸æˆåŒ–å­¦ä¹ **ï¼šé€šè¿‡é—¯å…³æ¨¡å¼å­¦ä¹ ç¼–ç¨‹
- ğŸ§© **å¯è§†åŒ–ç¼–ç¨‹**ï¼šä½¿ç”¨ç§¯æœ¨å¼ç¼–ç¨‹ç•Œé¢
- ğŸ‘¥ **å¤šè§’è‰²ç³»ç»Ÿ**ï¼šæ”¯æŒå­¦ç”Ÿã€æ•™å¸ˆã€å®¶é•¿ã€ç®¡ç†å‘˜
- ğŸ“Š **è¿›åº¦è¿½è¸ª**ï¼šå®æ—¶æŸ¥çœ‹å­¦ä¹ è¿›åº¦å’Œæˆå°±
- ğŸ† **æˆå°±ç³»ç»Ÿ**ï¼šæ”¶é›†å¾½ç« ã€è§£é”è£…æ‰®

---

## æŠ€æœ¯æ ˆ

### æ ¸å¿ƒæ¡†æ¶
- **React 18** - UI æ¡†æ¶
- **TypeScript** - ç±»å‹å®‰å…¨
- **Vite** - æ„å»ºå·¥å…·

### è·¯ç”±å’ŒçŠ¶æ€
- **React Router v6** - å®¢æˆ·ç«¯è·¯ç”±
- **Zustand** - è½»é‡çº§çŠ¶æ€ç®¡ç†
- **Zustand Persist** - çŠ¶æ€æŒä¹…åŒ–

### æ ·å¼
- **CSS Modules** - ç»„ä»¶æ ·å¼éš”ç¦»
- **è‡ªå®šä¹‰ CSS** - ç®€æ´çš„æ ·å¼ç³»ç»Ÿ

### å·¥å…·åº“
- **React Query** (å¯é€‰) - æ•°æ®è·å–å’Œç¼“å­˜
- **Jest** - å•å…ƒæµ‹è¯•
- **ESLint** - ä»£ç è§„èŒƒ

---

## é¡¹ç›®ç»“æ„

```
frontend/
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ student/              # å­¦ç”Ÿç«¯ç‹¬ç«‹ç»„ä»¶
â”‚   â”‚   â””â”€â”€ src/
â”‚   â”‚       â”œâ”€â”€ BlockEditor.tsx    # ç§¯æœ¨ç¼–ç¨‹ç¼–è¾‘å™¨
â”‚   â”‚       â”œâ”€â”€ GameCanvas.tsx     # æ¸¸æˆç”»å¸ƒ
â”‚   â”‚       â””â”€â”€ components.tsx     # å­¦ç”Ÿç«¯å·¥å…·ç»„ä»¶
â”‚   â”‚
â”‚   â”œâ”€â”€ teacher/              # æ•™å¸ˆç«¯ç‹¬ç«‹ç»„ä»¶
â”‚   â”‚   â””â”€â”€ src/
â”‚   â”‚       â”œâ”€â”€ LevelEditor.tsx    # å…³å¡ç¼–è¾‘å™¨
â”‚   â”‚       â””â”€â”€ components.tsx     # æ•™å¸ˆç«¯å·¥å…·ç»„ä»¶
â”‚   â”‚
â”‚   â””â”€â”€ web/                  # ä¸»åº”ç”¨
â”‚       â””â”€â”€ src/
â”‚           â”œâ”€â”€ app/                  # åº”ç”¨æ ¸å¿ƒ
â”‚           â”‚   â”œâ”€â”€ components/       # åº”ç”¨çº§ç»„ä»¶
â”‚           â”‚   â”‚   â”œâ”€â”€ AuthModal.tsx        # ç™»å½•æ¨¡æ€æ¡†ï¼ˆå¤‡ç”¨ï¼‰
â”‚           â”‚   â”‚   â””â”€â”€ auth-modal.css
â”‚           â”‚   â”‚
â”‚           â”‚   â”œâ”€â”€ layouts/          # å¸ƒå±€ç»„ä»¶
â”‚           â”‚   â”‚   â”œâ”€â”€ AppShell.tsx         # ä¸»æ¡†æ¶ï¼ˆå¯¼èˆªæ ç­‰ï¼‰
â”‚           â”‚   â”‚   â””â”€â”€ app-shell.css
â”‚           â”‚   â”‚
â”‚           â”‚   â”œâ”€â”€ pages/            # é¡µé¢ç»„ä»¶
â”‚           â”‚   â”‚   â”œâ”€â”€ admin/               # ç®¡ç†å‘˜é¡µé¢
â”‚           â”‚   â”‚   â”œâ”€â”€ parent/              # å®¶é•¿é¡µé¢
â”‚           â”‚   â”‚   â”œâ”€â”€ shared/              # å…±äº«é¡µé¢
â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ LoginPage.tsx    # ç™»å½•é¡µé¢
â”‚           â”‚   â”‚   â”‚   â””â”€â”€ login-page.css
â”‚           â”‚   â”‚   â”œâ”€â”€ student/             # å­¦ç”Ÿé¡µé¢
â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ HomePage.tsx           # å­¦ç”Ÿé¦–é¡µ
â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ LevelsPage.tsx         # å…³å¡åœ°å›¾
â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ LevelDetailPage.tsx    # å…³å¡è¯¦æƒ…
â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ PlayPage.tsx           # æ¸¸æˆé¡µé¢
â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ ResultPage.tsx         # ç»“æœé¡µé¢
â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ AchievementsPage.tsx   # æˆå°±é¡µé¢
â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ SettingsPage.tsx       # è®¾ç½®é¡µé¢
â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ StudentLayout.tsx      # å­¦ç”Ÿå¸ƒå±€
â”‚           â”‚   â”‚   â”‚   â””â”€â”€ student-layout.css
â”‚           â”‚   â”‚   â””â”€â”€ teacher/             # æ•™å¸ˆé¡µé¢
â”‚           â”‚   â”‚       â”œâ”€â”€ OverviewPage.tsx       # æ¦‚è§ˆ
â”‚           â”‚   â”‚       â”œâ”€â”€ ClassesPage.tsx        # ç­çº§åˆ—è¡¨
â”‚           â”‚   â”‚       â”œâ”€â”€ ClassDetailPage.tsx    # ç­çº§è¯¦æƒ…
â”‚           â”‚   â”‚       â”œâ”€â”€ AssignmentsPage.tsx    # ä½œä¸šç®¡ç†
â”‚           â”‚   â”‚       â”œâ”€â”€ ContentPage.tsx        # å†…å®¹ç®¡ç†
â”‚           â”‚   â”‚       â”œâ”€â”€ AnalyticsPage.tsx      # æ•°æ®åˆ†æ
â”‚           â”‚   â”‚       â”œâ”€â”€ TeacherLayout.tsx      # æ•™å¸ˆå¸ƒå±€
â”‚           â”‚   â”‚       â””â”€â”€ teacher-layout.css
â”‚           â”‚   â”‚
â”‚           â”‚   â”œâ”€â”€ providers/        # ä¸Šä¸‹æ–‡æä¾›è€…
â”‚           â”‚   â”‚   â”œâ”€â”€ AppErrorBoundary.tsx # é”™è¯¯è¾¹ç•Œ
â”‚           â”‚   â”‚   â””â”€â”€ FeatureFlagProvider.tsx
â”‚           â”‚   â”‚
â”‚           â”‚   â”œâ”€â”€ App.tsx           # åº”ç”¨æ ¹ç»„ä»¶
â”‚           â”‚   â”œâ”€â”€ providers.tsx     # Provider é›†åˆ
â”‚           â”‚   â””â”€â”€ routes.tsx        # è·¯ç”±é…ç½®
â”‚           â”‚
â”‚           â”œâ”€â”€ components/           # é€šç”¨ç»„ä»¶åº“
â”‚           â”‚   â””â”€â”€ ui/
â”‚           â”‚       â”œâ”€â”€ Badge.tsx           # å¾½ç« 
â”‚           â”‚       â”œâ”€â”€ Button.tsx          # æŒ‰é’®
â”‚           â”‚       â”œâ”€â”€ Card.tsx            # å¡ç‰‡
â”‚           â”‚       â”œâ”€â”€ Drawer.tsx          # æŠ½å±‰
â”‚           â”‚       â”œâ”€â”€ EmptyState.tsx      # ç©ºçŠ¶æ€
â”‚           â”‚       â”œâ”€â”€ Input.tsx           # è¾“å…¥æ¡†
â”‚           â”‚       â”œâ”€â”€ Modal.tsx           # æ¨¡æ€æ¡†
â”‚           â”‚       â”œâ”€â”€ Progress.tsx        # è¿›åº¦æ¡
â”‚           â”‚       â”œâ”€â”€ Select.tsx          # ä¸‹æ‹‰é€‰æ‹©
â”‚           â”‚       â”œâ”€â”€ Skeleton.tsx        # éª¨æ¶å±
â”‚           â”‚       â”œâ”€â”€ Table.tsx           # è¡¨æ ¼
â”‚           â”‚       â”œâ”€â”€ Tabs.tsx            # æ ‡ç­¾é¡µ
â”‚           â”‚       â”œâ”€â”€ TabSwitcher.tsx     # æ ‡ç­¾åˆ‡æ¢å™¨
â”‚           â”‚       â””â”€â”€ Toast.tsx           # æç¤ºæ¶ˆæ¯
â”‚           â”‚
â”‚           â”œâ”€â”€ services/             # æœåŠ¡å±‚
â”‚           â”‚   â””â”€â”€ api/
â”‚           â”‚       â””â”€â”€ client.ts           # API å®¢æˆ·ç«¯
â”‚           â”‚
â”‚           â”œâ”€â”€ store/                # çŠ¶æ€ç®¡ç†
â”‚           â”‚   â”œâ”€â”€ useAppStore.ts          # åº”ç”¨å…¨å±€çŠ¶æ€
â”‚           â”‚   â””â”€â”€ usePlaybackStore.ts     # æ¸¸æˆå›æ”¾çŠ¶æ€
â”‚           â”‚
â”‚           â”œâ”€â”€ hooks/                # è‡ªå®šä¹‰ Hooks
â”‚           â”‚   â””â”€â”€ useWebVitalsLogger.ts
â”‚           â”‚
â”‚           â”œâ”€â”€ utils/                # å·¥å…·å‡½æ•°
â”‚           â”‚   â””â”€â”€ featureFlags.ts
â”‚           â”‚
â”‚           â””â”€â”€ main.tsx              # åº”ç”¨å…¥å£
â”‚
â”œâ”€â”€ packages/                 # å…±äº«åŒ…
â”‚   â””â”€â”€ engine/
â”‚       â””â”€â”€ src/
â”‚           â”œâ”€â”€ index.ts              # æ¸¸æˆå¼•æ“
â”‚           â””â”€â”€ types.ts              # ç±»å‹å®šä¹‰
â”‚
â”œâ”€â”€ tests/                    # æµ‹è¯•æ–‡ä»¶
â”‚   â”œâ”€â”€ apps/
â”‚   â””â”€â”€ packages/
â”‚
â”œâ”€â”€ index.html               # HTML å…¥å£
â”œâ”€â”€ vite.config.ts           # Vite é…ç½®
â”œâ”€â”€ tsconfig.json            # TypeScript é…ç½®
â””â”€â”€ package.json             # é¡¹ç›®ä¾èµ–
```

---

## æ ¸å¿ƒåŠŸèƒ½

### 1. ç”¨æˆ·è®¤è¯ç³»ç»Ÿ

æ”¯æŒå››ç§ç™»å½•æ–¹å¼ï¼š

#### æ¸¸å®¢æ¨¡å¼
- å¿«é€Ÿä½“éªŒï¼Œæ— éœ€æ³¨å†Œ
- æ•°æ®ä¿å­˜åœ¨æœ¬åœ°
- åŠŸèƒ½å—é™

#### å­¦ç”Ÿç™»å½•
- ä½¿ç”¨ç­çº§é‚€è¯·ç åŠ å…¥
- è¾“å…¥å§“åå³å¯
- å¯ä»¥é—¯å…³å­¦ä¹ 

#### æ•™å¸ˆç™»å½•
- è´¦å·å¯†ç ç™»å½•
- ç®¡ç†ç­çº§å’Œå­¦ç”Ÿ
- æŸ¥çœ‹å­¦ä¹ æ•°æ®

#### å®¶é•¿ç™»å½•
- è´¦å·å¯†ç ç™»å½•
- æŸ¥çœ‹å­©å­è¿›åº¦
- æ¥æ”¶å­¦ä¹ æŠ¥å‘Š

**å®ç°æ–‡ä»¶ï¼š**
- `LoginPage.tsx` - ç™»å½•é¡µé¢
- `AuthModal.tsx` - ç™»å½•æ¨¡æ€æ¡†ï¼ˆå¤‡ç”¨ï¼‰
- `useAppStore.ts` - è®¤è¯çŠ¶æ€ç®¡ç†

### 2. å­¦ç”Ÿå­¦ä¹ ç³»ç»Ÿ

#### 2.1 é¦–é¡µ (HomePage)
- æ˜¾ç¤ºå­¦ä¹ è¿›åº¦
- æ¨èä¸‹ä¸€ä¸ªå…³å¡
- æ˜¾ç¤ºæœ€è¿‘å®Œæˆçš„å…³å¡
- å­¦ä¹ ç»Ÿè®¡ï¼ˆè¿ç»­å¤©æ•°ã€æœ¬å‘¨è¿›åº¦ç­‰ï¼‰

#### 2.2 å…³å¡åœ°å›¾ (LevelsPage)
- ç« èŠ‚å¼ç»„ç»‡
- å…³å¡è§£é”æœºåˆ¶
- ä¸‰æ˜Ÿè¯„ä»·ç³»ç»Ÿ
- è¿›åº¦å¯è§†åŒ–

#### 2.3 æ¸¸æˆé¡µé¢ (PlayPage)
- ç§¯æœ¨ç¼–ç¨‹ç¼–è¾‘å™¨
- å®æ—¶æ¸¸æˆç”»å¸ƒ
- æç¤ºç³»ç»Ÿ
- è¿è¡Œå’Œé‡ç½®åŠŸèƒ½

#### 2.4 æˆå°±ç³»ç»Ÿ (AchievementsPage)
- å¾½ç« æ”¶é›†
- è£…æ‰®è§£é”
- æˆå°±å±•ç¤º

### 3. æ•™å¸ˆç®¡ç†ç³»ç»Ÿ

#### 3.1 ç­çº§ç®¡ç†
- åˆ›å»ºå’Œç®¡ç†ç­çº§
- ç”Ÿæˆé‚€è¯·ç 
- æŸ¥çœ‹å­¦ç”Ÿåˆ—è¡¨

#### 3.2 ä½œä¸šç®¡ç†
- å¸ƒç½®å…³å¡ä½œä¸š
- è®¾ç½®æˆªæ­¢æ—¶é—´
- æŸ¥çœ‹å®Œæˆæƒ…å†µ

#### 3.3 æ•°æ®åˆ†æ
- å­¦ç”Ÿè¿›åº¦ç»Ÿè®¡
- å­¦ä¹ æ—¶é—´åˆ†æ
- éš¾ç‚¹è¯†åˆ«

#### 3.4 å†…å®¹ç®¡ç†
- è‡ªå®šä¹‰å…³å¡ï¼ˆæœªæ¥ï¼‰
- æ•™å­¦èµ„æºç®¡ç†

### 4. å®¶é•¿ç›‘æŠ¤ç³»ç»Ÿ

#### 4.1 è¿›åº¦æŸ¥çœ‹
- å­©å­å­¦ä¹ è¿›åº¦
- å­¦ä¹ æ—¶é•¿ç»Ÿè®¡
- æˆå°±å±•ç¤º

#### 4.2 å­¦ä¹ æŠ¥å‘Š
- å‘¨æŠ¥/æœˆæŠ¥
- å­¦ä¹ å»ºè®®

---

## è·¯ç”±ç³»ç»Ÿ

### è·¯ç”±ç»“æ„

```typescript
/                       â†’ é‡å®šå‘åˆ° /student
/login                  â†’ ç™»å½•é¡µé¢ï¼ˆç‹¬ç«‹ï¼Œæ—  AppShellï¼‰

# å­¦ç”Ÿç«¯è·¯ç”±
/student                â†’ å­¦ç”Ÿé¦–é¡µ
/student/levels         â†’ å…³å¡åœ°å›¾
/student/levels/:id     â†’ å…³å¡è¯¦æƒ…
/student/play/:id       â†’ æ¸¸æˆé¡µé¢
/student/result         â†’ ç»“æœé¡µé¢
/student/achievements   â†’ æˆå°±é¡µé¢
/student/settings       â†’ è®¾ç½®é¡µé¢

# æ•™å¸ˆç«¯è·¯ç”±
/teacher                â†’ æ•™å¸ˆæ¦‚è§ˆ
/teacher/classes        â†’ ç­çº§åˆ—è¡¨
/teacher/classes/:id    â†’ ç­çº§è¯¦æƒ…
/teacher/assignments    â†’ ä½œä¸šç®¡ç†
/teacher/content        â†’ å†…å®¹ç®¡ç†
/teacher/analytics      â†’ æ•°æ®åˆ†æ

# å®¶é•¿ç«¯è·¯ç”±
/parent                 â†’ å®¶é•¿é¦–é¡µ
/parent/progress        â†’ è¿›åº¦æŸ¥çœ‹
/parent/progress/:id    â†’ å­©å­è¯¦ç»†è¿›åº¦
/parent/settings        â†’ è®¾ç½®é¡µé¢

# ç®¡ç†ç«¯è·¯ç”±
/admin                  â†’ ç®¡ç†æ¦‚è§ˆ
/admin/users            â†’ ç”¨æˆ·ç®¡ç†
/admin/curriculum       â†’ è¯¾ç¨‹ç®¡ç†
/admin/ops              â†’ è¿è¥ç®¡ç†
/admin/settings         â†’ ç³»ç»Ÿè®¾ç½®
```

### è·¯ç”±ä¿æŠ¤

æœªç™»å½•ç”¨æˆ·è®¿é—®å—ä¿æŠ¤é¡µé¢æ—¶ï¼Œä¼šè‡ªåŠ¨é‡å®šå‘åˆ°ç™»å½•é¡µé¢ï¼Œå¹¶ä¿å­˜åŸå§‹è·¯å¾„ï¼š

```typescript
// ç¤ºä¾‹
è®¿é—®ï¼š/student/play/level-1
é‡å®šå‘åˆ°ï¼š/login?redirect=/student/play/level-1
ç™»å½•åè‡ªåŠ¨è¿”å›ï¼š/student/play/level-1
```

### å®ç°æ–‡ä»¶
- `routes.tsx` - è·¯ç”±é…ç½®
- `AppShell.tsx` - åº”ç”¨æ¡†æ¶å¸ƒå±€

---

## çŠ¶æ€ç®¡ç†

ä½¿ç”¨ **Zustand** è¿›è¡ŒçŠ¶æ€ç®¡ç†ï¼Œé…åˆ **Persist ä¸­é—´ä»¶** å®ç°çŠ¶æ€æŒä¹…åŒ–ã€‚

### ä¸»è¦ Store

#### 1. App Store (`useAppStore.ts`)

**ç”¨æˆ·çŠ¶æ€**
```typescript
user: User | StudentProfile | TeacherProfile | ParentProfile | undefined
isLoggedIn: boolean
```

**è®¤è¯ç›¸å…³**
```typescript
auth: {
  isOpen: boolean     // AuthModal æ˜¯å¦æ‰“å¼€
  mode: AuthMode      // 'guest' | 'student' | 'teacher' | 'parent'
}
```

**å­¦ç”Ÿç«¯æ•°æ®**
```typescript
chapters: Chapter[]       // ç« èŠ‚åˆ—è¡¨
currentChapter?: Chapter  // å½“å‰ç« èŠ‚
```

**æ¸¸æˆçŠ¶æ€**
```typescript
game: {
  currentLevel?: Level
  currentProgram: any[]
  simulationResult?: SimulationResult
  isRunning: boolean
  hints: string[]
  attempts: number
  lastError?: string
}
```

**UI çŠ¶æ€**
```typescript
loading: boolean
error?: string
```

**æ ¸å¿ƒæ–¹æ³•**

```typescript
// è®¤è¯
loginAsGuest(name?: string): Promise<boolean>
joinClass(inviteCode: string, name: string): Promise<boolean>
loginWithCredentials(payload): Promise<boolean>
logout(): void

// å­¦ç”Ÿæ•°æ®
loadStudentData(): Promise<void>
loadChapters(): Promise<void>

// æ¸¸æˆ
setCurrentLevel(level: Level): void
setProgram(program: any[]): void
runProgram(programOverride?: any[]): Promise<any>
completeLevel(data): Promise<void>
getHint(): Promise<void>
resetGame(): void
```

#### 2. Playback Store (`usePlaybackStore.ts`)

ç”¨äºæ¸¸æˆå›æ”¾å’ŒåŠ¨ç”»æ§åˆ¶ï¼ˆæœªæ¥æ‰©å±•ï¼‰ã€‚

### çŠ¶æ€æŒä¹…åŒ–

ä½¿ç”¨ Zustand çš„ `persist` ä¸­é—´ä»¶ï¼Œå°†ä»¥ä¸‹çŠ¶æ€ä¿å­˜åˆ° localStorageï¼š

```typescript
{
  name: 'app-storage',
  partialize: (state) => ({
    user: state.user,
    isLoggedIn: state.isLoggedIn
  })
}
```

---

## ç»„ä»¶åº“

### UI ç»„ä»¶æ¸…å•

æ‰€æœ‰ç»„ä»¶ä½äº `components/ui/` ç›®å½•ä¸‹ï¼š

#### 1. Badgeï¼ˆå¾½ç« ï¼‰
```tsx
<Badge tone="success">å®Œæˆ</Badge>
<Badge tone="info">è¿›è¡Œä¸­</Badge>
<Badge tone="warning">è­¦å‘Š</Badge>
<Badge tone="error">é”™è¯¯</Badge>
```

#### 2. Buttonï¼ˆæŒ‰é’®ï¼‰
```tsx
<Button variant="primary">ä¸»è¦æŒ‰é’®</Button>
<Button variant="secondary">æ¬¡è¦æŒ‰é’®</Button>
<Button variant="ghost">å¹½çµæŒ‰é’®</Button>
<Button loading={true}>åŠ è½½ä¸­...</Button>
<Button disabled>ç¦ç”¨</Button>
```

#### 3. Cardï¼ˆå¡ç‰‡ï¼‰
```tsx
<Card 
  title="æ ‡é¢˜"
  subtitle="å‰¯æ ‡é¢˜"
  actions={<Button>æ“ä½œ</Button>}
>
  å†…å®¹
</Card>
```

#### 4. Modalï¼ˆæ¨¡æ€æ¡†ï¼‰
```tsx
<Modal
  title="æ ‡é¢˜"
  open={isOpen}
  onClose={handleClose}
  primaryAction={{ label: 'ç¡®å®š', onClick: handleConfirm }}
  secondaryAction={{ label: 'å–æ¶ˆ', onClick: handleClose }}
>
  æ¨¡æ€æ¡†å†…å®¹
</Modal>
```

#### 5. Inputï¼ˆè¾“å…¥æ¡†ï¼‰
```tsx
<Input
  type="text"
  placeholder="è¯·è¾“å…¥"
  value={value}
  onChange={handleChange}
  maxLength={20}
/>
```

#### 6. Progressï¼ˆè¿›åº¦æ¡ï¼‰
```tsx
<Progress value={75} label="75%" />
```

#### 7. Toastï¼ˆæç¤ºæ¶ˆæ¯ï¼‰
```tsx
const { showToast } = useToast();
showToast('æ“ä½œæˆåŠŸ', 'success');
```

#### 8. Skeletonï¼ˆéª¨æ¶å±ï¼‰
```tsx
<Skeleton height={200} />
```

#### 9. EmptyStateï¼ˆç©ºçŠ¶æ€ï¼‰
```tsx
<EmptyState
  title="æš‚æ— æ•°æ®"
  description="è¿˜æ²¡æœ‰ä»»ä½•å†…å®¹"
  actions={<Button>æ·»åŠ </Button>}
/>
```

#### 10. Tableï¼ˆè¡¨æ ¼ï¼‰
```tsx
<Table
  columns={[
    { key: 'name', label: 'å§“å' },
    { key: 'score', label: 'åˆ†æ•°' }
  ]}
  data={students}
/>
```

#### 11. Tabsï¼ˆæ ‡ç­¾é¡µï¼‰
```tsx
<Tabs
  tabs={[
    { id: 'tab1', label: 'æ ‡ç­¾1', content: <div>å†…å®¹1</div> },
    { id: 'tab2', label: 'æ ‡ç­¾2', content: <div>å†…å®¹2</div> }
  ]}
/>
```

#### 12. TabSwitcherï¼ˆæ ‡ç­¾åˆ‡æ¢å™¨ï¼‰
```tsx
<TabSwitcher
  tabs={[
    { id: 'tab1', label: 'æ ‡ç­¾1', icon: 'ğŸ ' },
    { id: 'tab2', label: 'æ ‡ç­¾2', icon: 'âš™ï¸' }
  ]}
  activeTab={activeTab}
  onTabChange={setActiveTab}
/>
```

#### 13. Selectï¼ˆä¸‹æ‹‰é€‰æ‹©ï¼‰
```tsx
<Select
  options={[
    { value: '1', label: 'é€‰é¡¹1' },
    { value: '2', label: 'é€‰é¡¹2' }
  ]}
  value={selectedValue}
  onChange={handleChange}
/>
```

#### 14. Drawerï¼ˆæŠ½å±‰ï¼‰
```tsx
<Drawer
  open={isOpen}
  onClose={handleClose}
  title="æŠ½å±‰æ ‡é¢˜"
>
  æŠ½å±‰å†…å®¹
</Drawer>
```

### ç»„ä»¶è®¾è®¡åŸåˆ™

1. **ç®€æ´æ€§**ï¼šAPI ç®€å•ç›´è§‚
2. **å¯å®šåˆ¶**ï¼šæ”¯æŒ className å’Œ style props
3. **æ— éšœç¢**ï¼šæ”¯æŒé”®ç›˜å¯¼èˆªå’Œå±å¹•é˜…è¯»å™¨
4. **å“åº”å¼**ï¼šé€‚é…ç§»åŠ¨å’Œæ¡Œé¢è®¾å¤‡

---

## API é›†æˆ

### API Client (`services/api/client.ts`)

ç»Ÿä¸€çš„ API è°ƒç”¨æ¥å£ï¼ŒåŸºäº RESTful è®¾è®¡ã€‚

#### ä¸»è¦æ–¹æ³•

**è®¤è¯ç›¸å…³**
```typescript
loginAsGuest(name?: string): Promise<ApiResponse<LoginResponse>>
joinClass(inviteCode: string, name: string): Promise<ApiResponse<JoinClassResponse>>
loginWithCredentials(payload): Promise<ApiResponse<LoginResponse>>
```

**å­¦ç”Ÿç«¯**
```typescript
getStudentProfile(): Promise<ApiResponse<StudentProfile>>
getStudentMap(): Promise<ApiResponse<{ chapters: Chapter[] }>>
getStudentLevel(levelId: string): Promise<ApiResponse<Level>>
getLevelPrep(levelId: string): Promise<ApiResponse<LevelPrep>>
runLevel(levelId: string, program: any[]): Promise<ApiResponse<SimulationResult>>
completeLevel(levelId: string, data): Promise<ApiResponse<void>>
getHint(levelId: string, context): Promise<ApiResponse<{ hint: string }>>
```

**æ•™å¸ˆç«¯**
```typescript
getTeacherProfile(): Promise<ApiResponse<TeacherProfile>>
getTeacherClasses(): Promise<ApiResponse<Class[]>>
getClassDetail(classId: string): Promise<ApiResponse<ClassDetail>>
createClass(data): Promise<ApiResponse<Class>>
```

**å®¶é•¿ç«¯**
```typescript
getParentProfile(): Promise<ApiResponse<ParentProfile>>
getChildrenProgress(): Promise<ApiResponse<ChildProgress[]>>
```

#### ç±»å‹å®šä¹‰

æ‰€æœ‰ API ç›¸å…³çš„ç±»å‹éƒ½åœ¨ `client.ts` ä¸­å®šä¹‰ï¼š

```typescript
// ç”¨æˆ·ç±»å‹
export interface User {
  id: string;
  name: string;
  role: 'student' | 'teacher' | 'parent' | 'admin';
  classId?: string;
}

export interface StudentProfile extends User {
  role: 'student';
  avatar?: {
    equipped: string;
    unlocked: string[];
  };
  badges: Badge[];
  sandboxUnlocked: boolean;
}

// ç« èŠ‚å’Œå…³å¡
export interface Chapter {
  id: string;
  name: string;
  description: string;
  levels: Level[];
}

export interface Level {
  id: string;
  name: string;
  description: string;
  status: 'locked' | 'unlocked' | 'completed';
  stars: number;
  bestSteps: number;
  allowedBlocks: string[];
  goal: VictoryCondition;
  // ... æ›´å¤šå­—æ®µ
}

// API å“åº”
export interface ApiResponse<T> {
  data?: T;
  error?: string;
}
```

#### é”™è¯¯å¤„ç†

API è°ƒç”¨å¤±è´¥æ—¶è¿”å› error å­—æ®µï¼š

```typescript
const response = await apiClient.getStudentProfile();
if (response.error) {
  console.error('è·å–æ•°æ®å¤±è´¥:', response.error);
  // å¤„ç†é”™è¯¯
}
```

---

## æ¸¸æˆå¼•æ“

### æ¸¸æˆå¼•æ“ (`packages/engine/`)

è´Ÿè´£ç¨‹åºæ‰§è¡Œå’Œæ¸¸æˆé€»è¾‘æ¨¡æ‹Ÿã€‚

#### æ ¸å¿ƒåŠŸèƒ½

1. **ç¨‹åºè§£é‡Šå™¨**ï¼šè§£æç§¯æœ¨ç¨‹åº
2. **æ¸¸æˆçŠ¶æ€ç®¡ç†**ï¼šè·Ÿè¸ªè§’è‰²ä½ç½®ã€æ”¶é›†ç‰©ç­‰
3. **ç¢°æ’æ£€æµ‹**ï¼šæ£€æŸ¥è§’è‰²ç§»åŠ¨æ˜¯å¦åˆæ³•
4. **èƒœåˆ©æ¡ä»¶åˆ¤æ–­**ï¼šåˆ¤æ–­æ˜¯å¦å®Œæˆå…³å¡ç›®æ ‡

#### ç±»å‹å®šä¹‰ (`types.ts`)

```typescript
// æŒ‡ä»¤ç±»å‹
export type BlockType = 
  | 'MOVE' 
  | 'TURN_LEFT' 
  | 'TURN_RIGHT' 
  | 'COLLECT'
  | 'REPEAT'
  | 'CONDITIONAL';

// æ¸¸æˆçŠ¶æ€
export interface GameState {
  character: {
    x: number;
    y: number;
    direction: Direction;
  };
  collectibles: Position[];
  obstacles: Position[];
}

// æ‰§è¡Œç»“æœ
export interface SimulationResult {
  success: boolean;
  steps: number;
  stars: number;
  log: GameLog[];
  errorCode?: string;
}
```

#### ä½¿ç”¨ç¤ºä¾‹

```typescript
import { executeProgram } from '@packages/engine';

const result = await executeProgram(program, level);
if (result.success) {
  console.log(`å®Œæˆå…³å¡ï¼Œè·å¾— ${result.stars} æ˜Ÿ`);
} else {
  console.log(`å¤±è´¥ï¼š${result.errorCode}`);
}
```

---

## å¼€å‘æŒ‡å—

### ç¯å¢ƒå‡†å¤‡

1. **å®‰è£…ä¾èµ–**
```bash
cd frontend
npm install
```

2. **å¯åŠ¨å¼€å‘æœåŠ¡å™¨**
```bash
npm run dev
```

3. **æ„å»ºç”Ÿäº§ç‰ˆæœ¬**
```bash
npm run build
```

4. **è¿è¡Œæµ‹è¯•**
```bash
npm test
```

### å¼€å‘è§„èŒƒ

#### 1. æ–‡ä»¶å‘½å
- ç»„ä»¶æ–‡ä»¶ï¼šPascalCaseï¼Œå¦‚ `HomePage.tsx`
- æ ·å¼æ–‡ä»¶ï¼škebab-caseï¼Œå¦‚ `home-page.css`
- å·¥å…·æ–‡ä»¶ï¼šcamelCaseï¼Œå¦‚ `utils.ts`

#### 2. ç»„ä»¶ç¼–å†™

ä½¿ç”¨å‡½æ•°ç»„ä»¶å’Œ Hooksï¼š

```tsx
import { useState, useEffect } from 'react';

export const MyComponent = () => {
  const [count, setCount] = useState(0);

  useEffect(() => {
    // å‰¯ä½œç”¨
  }, []);

  return <div>{count}</div>;
};

export default MyComponent;
```

#### 3. ç±»å‹å®šä¹‰

ä¼˜å…ˆä½¿ç”¨ TypeScript ç±»å‹ï¼š

```typescript
interface Props {
  title: string;
  count?: number;
  onSubmit: (value: string) => void;
}

export const MyComponent: React.FC<Props> = ({ title, count = 0, onSubmit }) => {
  // ...
};
```

#### 4. æ ·å¼ç¼–å†™

ä½¿ç”¨ CSS Modules æˆ–æ™®é€š CSSï¼š

```css
/* my-component.css */
.container {
  padding: 1rem;
  background: white;
}

.title {
  font-size: 1.5rem;
  font-weight: bold;
}
```

```tsx
import './my-component.css';

export const MyComponent = () => {
  return (
    <div className="container">
      <h1 className="title">æ ‡é¢˜</h1>
    </div>
  );
};
```

#### 5. çŠ¶æ€ç®¡ç†

ä½¿ç”¨ Zustand Storeï¼š

```typescript
const { user, setUser } = useAppStore((state) => ({
  user: state.user,
  setUser: state.setUser,
}));
```

#### 6. API è°ƒç”¨

ä½¿ç”¨ API Clientï¼š

```typescript
const response = await apiClient.getStudentProfile();
if (response.error) {
  setError(response.error);
  return;
}
setProfile(response.data);
```

### å¸¸è§é—®é¢˜

#### 1. Hooks é¡ºåºé—®é¢˜

**é”™è¯¯ç¤ºä¾‹**ï¼š
```tsx
const MyComponent = () => {
  if (condition) {
    return <div>Early return</div>;
  }
  
  const [count, setCount] = useState(0); // âŒ é”™è¯¯ï¼Hooks åœ¨æ¡ä»¶ä¹‹å
};
```

**æ­£ç¡®ç¤ºä¾‹**ï¼š
```tsx
const MyComponent = () => {
  const [count, setCount] = useState(0); // âœ… æ­£ç¡®ï¼Hooks åœ¨æœ€å‰é¢
  
  if (condition) {
    return <div>Early return</div>;
  }
};
```

#### 2. è·¯ç”±è·³è½¬

ä½¿ç”¨ `useNavigate` Hookï¼š

```tsx
const navigate = useNavigate();

const handleClick = () => {
  navigate('/student/levels');
};
```

#### 3. çŠ¶æ€æ›´æ–°

ä½¿ç”¨ Zustand çš„ set æ–¹æ³•ï¼š

```typescript
// Store å®šä¹‰
set((state) => ({
  user: newUser,
  isLoggedIn: true
}));

// æˆ–è€…ä½¿ç”¨ get è·å–å½“å‰çŠ¶æ€
set((state) => ({
  count: get().count + 1
}));
```

### æ€§èƒ½ä¼˜åŒ–

1. **æ‡’åŠ è½½**ï¼šä½¿ç”¨ `React.lazy` å’Œ `Suspense`
2. **Memo**ï¼šä½¿ç”¨ `React.memo` é¿å…ä¸å¿…è¦çš„é‡æ¸²æŸ“
3. **useCallback/useMemo**ï¼šç¼“å­˜å‡½æ•°å’Œè®¡ç®—ç»“æœ
4. **ä»£ç åˆ†å‰²**ï¼šæŒ‰è·¯ç”±åˆ†å‰²ä»£ç 

### è°ƒè¯•æŠ€å·§

1. **React DevTools**ï¼šæŸ¥çœ‹ç»„ä»¶æ ‘å’Œ props
2. **Console.log**ï¼šåœ¨å…³é”®ä½ç½®æ·»åŠ æ—¥å¿—
3. **Zustand DevTools**ï¼šæŸ¥çœ‹çŠ¶æ€å˜åŒ–
4. **Network é¢æ¿**ï¼šæŸ¥çœ‹ API è¯·æ±‚

---

## æ€»ç»“

ä»£ç å¥‡å…µå‰ç«¯é¡¹ç›®é‡‡ç”¨ç°ä»£åŒ–çš„ React æŠ€æœ¯æ ˆï¼Œç»“æ„æ¸…æ™°ã€æ˜“äºç»´æŠ¤ã€‚æ ¸å¿ƒç‰¹ç‚¹ï¼š

- âœ… **æ¨¡å—åŒ–è®¾è®¡**ï¼šæŒ‰åŠŸèƒ½å’Œè§’è‰²åˆ†ç¦»ç»„ä»¶
- âœ… **ç±»å‹å®‰å…¨**ï¼šå…¨é¢ä½¿ç”¨ TypeScript
- âœ… **çŠ¶æ€ç®¡ç†**ï¼šZustand è½»é‡é«˜æ•ˆ
- âœ… **ç»„ä»¶å¤ç”¨**ï¼šä¸°å¯Œçš„ UI ç»„ä»¶åº“
- âœ… **ç”¨æˆ·ä½“éªŒ**ï¼šå“åº”å¼è®¾è®¡å’ŒåŠ è½½çŠ¶æ€

å¦‚æœ‰é—®é¢˜ï¼Œè¯·å‚è€ƒå…¶ä»–æ–‡æ¡£æˆ–è”ç³»å¼€å‘å›¢é˜Ÿã€‚

